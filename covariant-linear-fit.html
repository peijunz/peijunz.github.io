<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Covariant Linear Fit - Peijun's Journal</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">


    <link href="https://www.peijun.me//static/binary.png" rel="icon">

<link rel="canonical" href="https://www.peijun.me/covariant-linear-fit.html">

        <meta name="author" content="Peijun Zhu" />
        <meta name="description" content="# AimMinimize $$\sum_i \mathrm{distance}^2(\vec r_i, \mathrm{line})=\sum_i (\vec r_i\cdot \hat n-\rho)^2$$ for line $\vec r\cdot \hat n-\rho=0$. It is equivalent to The principle axis with least moment of inertia The eigenvector with largest eigenval for the covariance matrix" />

        <meta property="og:site_name" content="Peijun's Journal" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Covariant Linear Fit"/>
        <meta property="og:url" content="https://www.peijun.me/covariant-linear-fit.html"/>
        <meta property="og:description" content="# AimMinimize $$\sum_i \mathrm{distance}^2(\vec r_i, \mathrm{line})=\sum_i (\vec r_i\cdot \hat n-\rho)^2$$ for line $\vec r\cdot \hat n-\rho=0$. It is equivalent to The principle axis with least moment of inertia The eigenvector with largest eigenval for the covariance matrix"/>
        <meta property="article:published_time" content="2017-05-29" />
            <meta property="article:section" content="Computer" />
            <meta property="article:author" content="Peijun Zhu" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://www.peijun.me/theme/css/bootstrap.cosmo.min.css" type="text/css"/>
    <link href="https://www.peijun.me/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://www.peijun.me/theme/css/pygments/default.css" rel="stylesheet">
    <link href="https://www.peijun.me/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="https://www.peijun.me/theme/css/style.css" type="text/css"/>
        <link href="https://www.peijun.me/static/css/custom.css" rel="stylesheet">

        <link href="https://www.peijun.me/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Peijun's Journal ATOM Feed"/>




</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://www.peijun.me/" class="navbar-brand">
Peijun's Journal            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/archives.html">Archives</a></li>
                    <li><a href="/categories.html">Categories</a></li>
                    <li><a href="/tags.html">Tags</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="https://www.peijun.me/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <ol class="breadcrumb">
                <li><a href="https://www.peijun.me/categories.html" title="Peijun's Journal"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="https://www.peijun.me/category/computer.html" title="Computer">Computer</a></li>
                <li class="active">Covariant Linear Fit</li>
            </ol>
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://www.peijun.me/covariant-linear-fit.html"
                       rel="bookmark"
                       title="Permalink to Covariant Linear Fit">
                        Covariant Linear Fit
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-05-29T00:00:00-04:00"> Mon, 29 May 2017</time>
    </span>





    
</footer><!-- /.post-info -->                    </div>
                </div>
                <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Aim"><a class="anchor-link" href="#Aim">#</a> Aim</h2><p>Minimize $$\sum_i \mathrm{distance}^2(\vec r_i, \mathrm{line})=\sum_i (\vec r_i\cdot \hat n-\rho)^2$$
for line $\vec r\cdot \hat n-\rho=0$. It is equivalent to</p>
<ul>
<li>The principle axis with least moment of inertia</li>
<li>The eigenvector with largest eigenval for the covariance matrix</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="When-is-it-useful?"><a class="anchor-link" href="#When-is-it-useful?">#</a> When is it useful?</h2><p>Only when fitting geometrical dots, which should be rotational invariant. Ordinary linear fit does not has such an invariance.</p>
<p>For most common case, the $x, y$ has different dimension. As an example, the relation between weight $w$ and height $h$ is not invariant under rotation, because there is no mixture between them. In this condition, we need invariance of scaling for any axis.</p>
<h2 id="Code"><a class="anchor-link" href="#Code">#</a> Code</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">clinearfit</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">lx</span><span class="p">),</span> <span class="n">mean</span><span class="p">(</span><span class="n">ly</span><span class="p">)</span>
    <span class="n">val</span><span class="p">,</span> <span class="n">vec</span><span class="o">=</span><span class="n">eigh</span><span class="p">(</span><span class="n">cov</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">))</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]),</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [118]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fitline</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">center</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="n">clinearfit</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">direct</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">k</span><span class="o">=</span><span class="n">direct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">direct</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dr</span><span class="o">=</span><span class="n">transpose</span><span class="p">(</span><span class="n">vstack</span><span class="p">([</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">]))</span><span class="o">-</span><span class="n">center</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">dot</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="n">direct</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span><span class="k">return</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x</span><span class="o">=</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">ds</span><span class="p">)])</span><span class="o">*</span><span class="n">direct</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">d</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-=</span><span class="n">extend</span><span class="o">*</span><span class="n">d</span>
    <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">extend</span><span class="o">*</span><span class="n">d</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Probabilistic"><a class="anchor-link" href="#Probabilistic">#</a> Probabilistic</h2><p>The likelihood is ?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [126]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">lx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.4</span><span class="p">]</span>
<span class="n">ly</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">]</span>
<span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">fitline</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">)</span>
<span class="n">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_svg output_subarea">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<!-- Created with matplotlib (http://matplotlib.org/) -->
<svg height="252pt" version="1.1" viewbox="0 0 375 252" width="375pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style>
</defs>
<g id="figure_1">
<g id="patch_1">
<path d="M 0 252.018125 
L 375.603125 252.018125 
L 375.603125 0 
L 0 0 
z
" style="fill:none;"></path>
</g>
<g id="axes_1">
<g id="patch_2">
<path d="M 30.103125 228.14 
L 364.903125 228.14 
L 364.903125 10.7 
L 30.103125 10.7 
z
" style="fill:#ffffff;"></path>
</g>
<g id="matplotlib.axis_1">
<g id="xtick_1">
<g id="line2d_1">
<defs>
<path d="M 0 0 
L 0 3.5 
" id="mefeb33d786" style="stroke:#000000;stroke-width:0.8;"></path>
</defs>
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="53.049978" xlink:href="#mefeb33d786" y="228.14"></use>
</g>
</g>
<g id="text_1">
<!-- −0.2 -->
<defs>
<path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-2212"></path>
<path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
" id="DejaVuSans-30"></path>
<path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-2e"></path>
<path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
" id="DejaVuSans-32"></path>
</defs>
<g transform="translate(40.908572 242.738437)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-2212"></use>
<use x="83.789062" xlink:href="#DejaVuSans-30"></use>
<use x="147.412109" xlink:href="#DejaVuSans-2e"></use>
<use x="179.199219" xlink:href="#DejaVuSans-32"></use>
</g>
</g>
</g>
<g id="xtick_2">
<g id="line2d_2">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="113.872356" xlink:href="#mefeb33d786" y="228.14"></use>
</g>
</g>
<g id="text_2">
<!-- 0.0 -->
<g transform="translate(105.920793 242.738437)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-30"></use>
</g>
</g>
</g>
<g id="xtick_3">
<g id="line2d_3">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="174.694733" xlink:href="#mefeb33d786" y="228.14"></use>
</g>
</g>
<g id="text_3">
<!-- 0.2 -->
<g transform="translate(166.743171 242.738437)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-32"></use>
</g>
</g>
</g>
<g id="xtick_4">
<g id="line2d_4">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="235.517111" xlink:href="#mefeb33d786" y="228.14"></use>
</g>
</g>
<g id="text_4">
<!-- 0.4 -->
<defs>
<path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-34"></path>
</defs>
<g transform="translate(227.565549 242.738437)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-34"></use>
</g>
</g>
</g>
<g id="xtick_5">
<g id="line2d_5">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="296.339489" xlink:href="#mefeb33d786" y="228.14"></use>
</g>
</g>
<g id="text_5">
<!-- 0.6 -->
<defs>
<path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
" id="DejaVuSans-36"></path>
</defs>
<g transform="translate(288.387926 242.738437)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-36"></use>
</g>
</g>
</g>
<g id="xtick_6">
<g id="line2d_6">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="357.161866" xlink:href="#mefeb33d786" y="228.14"></use>
</g>
</g>
<g id="text_6">
<!-- 0.8 -->
<defs>
<path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
" id="DejaVuSans-38"></path>
</defs>
<g transform="translate(349.210304 242.738437)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-38"></use>
</g>
</g>
</g>
</g>
<g id="matplotlib.axis_2">
<g id="ytick_1">
<g id="line2d_7">
<defs>
<path d="M 0 0 
L -3.5 0 
" id="m09df216f76" style="stroke:#000000;stroke-width:0.8;"></path>
</defs>
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="30.103125" xlink:href="#m09df216f76" y="203.050769"></use>
</g>
</g>
<g id="text_7">
<!-- 0.0 -->
<g transform="translate(7.2 206.849988)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-30"></use>
</g>
</g>
</g>
<g id="ytick_2">
<g id="line2d_8">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="30.103125" xlink:href="#m09df216f76" y="172.63958"></use>
</g>
</g>
<g id="text_8">
<!-- 0.1 -->
<defs>
<path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-31"></path>
</defs>
<g transform="translate(7.2 176.438799)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-31"></use>
</g>
</g>
</g>
<g id="ytick_3">
<g id="line2d_9">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="30.103125" xlink:href="#m09df216f76" y="142.228392"></use>
</g>
</g>
<g id="text_9">
<!-- 0.2 -->
<g transform="translate(7.2 146.02761)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-32"></use>
</g>
</g>
</g>
<g id="ytick_4">
<g id="line2d_10">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="30.103125" xlink:href="#m09df216f76" y="111.817203"></use>
</g>
</g>
<g id="text_10">
<!-- 0.3 -->
<defs>
<path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
" id="DejaVuSans-33"></path>
</defs>
<g transform="translate(7.2 115.616422)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-33"></use>
</g>
</g>
</g>
<g id="ytick_5">
<g id="line2d_11">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="30.103125" xlink:href="#m09df216f76" y="81.406014"></use>
</g>
</g>
<g id="text_11">
<!-- 0.4 -->
<g transform="translate(7.2 85.205233)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-34"></use>
</g>
</g>
</g>
<g id="ytick_6">
<g id="line2d_12">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="30.103125" xlink:href="#m09df216f76" y="50.994825"></use>
</g>
</g>
<g id="text_12">
<!-- 0.5 -->
<defs>
<path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-35"></path>
</defs>
<g transform="translate(7.2 54.794044)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-35"></use>
</g>
</g>
</g>
<g id="ytick_7">
<g id="line2d_13">
<g>
<use style="stroke:#000000;stroke-width:0.8;" x="30.103125" xlink:href="#m09df216f76" y="20.583636"></use>
</g>
</g>
<g id="text_13">
<!-- 0.6 -->
<g transform="translate(7.2 24.382855)scale(0.1 -0.1)">
<use xlink:href="#DejaVuSans-30"></use>
<use x="63.623047" xlink:href="#DejaVuSans-2e"></use>
<use x="95.410156" xlink:href="#DejaVuSans-36"></use>
</g>
</g>
</g>
</g>
<g id="line2d_14">
<defs>
<path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="mb0a47698c4" style="stroke:#1f77b4;"></path>
</defs>
<g clip-path="url(#p2bd6ae5000)">
<use style="fill:#1f77b4;stroke:#1f77b4;" x="113.872356" xlink:href="#mb0a47698c4" y="203.050769"></use>
<use style="fill:#1f77b4;stroke:#1f77b4;" x="296.339489" xlink:href="#mb0a47698c4" y="81.406014"></use>
<use style="fill:#1f77b4;stroke:#1f77b4;" x="235.517111" xlink:href="#mb0a47698c4" y="20.583636"></use>
</g>
</g>
<g id="line2d_15">
<path clip-path="url(#p2bd6ae5000)" d="M 98.666761 218.256364 
L 281.133894 35.789231 
" style="fill:none;stroke:#ff7f0e;stroke-linecap:square;stroke-width:1.5;"></path>
</g>
<g id="patch_3">
<path d="M 30.103125 228.14 
L 30.103125 10.7 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
</g>
<g id="patch_4">
<path d="M 364.903125 228.14 
L 364.903125 10.7 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
</g>
<g id="patch_5">
<path d="M 30.103125 228.14 
L 364.903125 228.14 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
</g>
<g id="patch_6">
<path d="M 30.103125 10.7 
L 364.903125 10.7 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
</g>
</g>
</g>
<defs>
<clippath id="p2bd6ae5000">
<rect height="217.44" width="334.8" x="30.103125" y="10.7"></rect>
</clippath>
</defs>
</svg>
</div>
</div>
</div>
</div>
</div>

            </div>
            <!-- /.entry-content -->
<ul class="pager">
    <li class="previous"><a href="https://www.peijun.me/convert-strarray-back-to-numpy-array.html">&larr; Convert str(array) back to numpy array</a></li>
    <li class="next"><a href="https://www.peijun.me/processing-the-capillary-force-video.html">Processing the capillary force video &rarr;</a></li>
</ul>    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'peijunz'; // required: replace example with your forum shortname

                    var disqus_identifier = 'covariant-linear-fit';
                var disqus_url = 'https://www.peijun.me/covariant-linear-fit.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
<script>
    window.MathJax = {
      tex: {
        tags: 'ams',
        inlineMath: [ ['$','$'] ],
        displayMath: [ ['$$','$$'] ],
        processEscapes: true,
        processEnvironments: true,
        packages: {'[+]': ['noerrors']}
      },
      loader: {
        load: ['[tex]/noerrors']
      }
    };
</script>
<script type="text/javascript" id="MathJax-script"
async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        </article>
    </section>

        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">
         <i class="fa fa-github fa-lg"></i> <a href="https://github.com/peijunz">peijunz</a><br><br>
&copy; 2020 Peijun Zhu
             &middot; Powered by <a href="https://github.com/peijunz/ipynb2pelican" target="_blank">ipynb2pelican</a>, <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<p>
  <span id="busuanzi_container_site_pv"><small>
  Total Views: <span id="busuanzi_value_site_pv"></span>,
  Visitors: <span id="busuanzi_value_site_uv"></span>,
  Current: <span id="busuanzi_value_page_pv"></span></small>
  </span>
<p>
                <p><small>  <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">Creative Commons Attribution-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script type="text/javascript">
    function changeThemeColor() {
        var elements = document.getElementsByClassName('navbar-fixed-top');
        if(elements){
        	var theme_color = window.getComputedStyle(elements[0], null).color;
            var metaThemeColor = document.querySelector("meta[name=theme-color]");
            metaThemeColor.setAttribute("content", theme_color);
        }
    };
    changeThemeColor();
</script>
<script src="https://www.peijun.me/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://www.peijun.me/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://www.peijun.me/theme/js/respond.min.js"></script>


    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'peijunz'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-96594625-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->


</body>
</html>